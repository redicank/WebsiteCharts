<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Teaching Evaluation: Knowledge Gains</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,500;0,700;1,500&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --kyle:    #990000;
      --geo:     #C8A951;
      --univ:    #6B8CA4;
      --bg:      #FAFAF7;
      --surface: #FFFFFF;
      --border:  #E8E4DC;
      --text:    #1A1714;
      --muted:   #7A7570;
    }

    body {
      background: var(--bg);
      font-family: 'DM Sans', sans-serif;
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }

    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 2.5rem 2.5rem 2rem;
      max-width: 800px;
      width: 100%;
      box-shadow: 0 2px 24px rgba(0,0,0,0.06);
      animation: fadeUp 0.6s ease both;
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(16px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px solid var(--border);
    }

    .header-left {
      flex: 1;
    }

    .eyebrow {
      font-size: 0.7rem;
      font-weight: 500;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: var(--muted);
      margin-bottom: 0.5rem;
    }

    h1 {
      font-family: 'Playfair Display', serif;
      font-size: 1.45rem;
      font-weight: 500;
      line-height: 1.3;
      color: var(--text);
      max-width: 420px;
    }

    h1 em {
      font-style: italic;
      color: var(--kyle);
    }

    .scale-note {
      font-size: 0.72rem;
      color: var(--muted);
      margin-top: 0.4rem;
      font-weight: 300;
    }

    .stat-block {
      text-align: right;
      flex-shrink: 0;
    }

    .stat-value {
      font-family: 'Playfair Display', serif;
      font-size: 2.4rem;
      font-weight: 700;
      color: var(--kyle);
      line-height: 1;
    }

    .stat-label {
      font-size: 0.68rem;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-top: 0.3rem;
    }

    .chart-wrap {
      position: relative;
      height: 300px;
      width: 100%;
    }

    .legend {
      display: flex;
      gap: 1.5rem;
      margin-top: 1.4rem;
      flex-wrap: wrap;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.45rem;
      font-size: 0.78rem;
      color: var(--muted);
      cursor: pointer;
      transition: color 0.2s;
    }

    .legend-item:hover { color: var(--text); }

    .legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .legend-item[data-id="kyle"] .legend-dot { background: var(--kyle); }
    .legend-item[data-id="geo"]  .legend-dot { background: var(--geo); }
    .legend-item[data-id="univ"] .legend-dot { background: var(--univ); }

    .legend-name {
      font-weight: 500;
      color: inherit;
    }

    .footer-note {
      margin-top: 1.2rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border);
      font-size: 0.68rem;
      color: var(--muted);
      font-style: italic;
    }
  </style>
</head>
<body>
<div class="card">
  <div class="header">
    <div class="header-left">
      <p class="eyebrow">Course Evaluation · Fall 2022 – Fall 2025</p>
      <h1>"This course <em>significantly</em> increased my knowledge of the subject."</h1>
      <p class="scale-note">5-point agreement scale &nbsp;·&nbsp; Higher is better</p>
    </div>
    <div class="stat-block">
      <div class="stat-value">4.79</div>
      <div class="stat-label">My avg. score</div>
    </div>
  </div>

  <div class="chart-wrap">
    <canvas id="chart"></canvas>
  </div>

  <div class="legend">
    <div class="legend-item" data-id="kyle">
      <div class="legend-dot"></div>
      <span class="legend-name">My Courses</span>
    </div>
    <div class="legend-item" data-id="geo">
      <div class="legend-dot"></div>
      <span class="legend-name">Geography Dept. Avg.</span>
    </div>
    <div class="legend-item" data-id="univ">
      <div class="legend-dot"></div>
      <span class="legend-name">University Avg.</span>
    </div>
  </div>

  <p class="footer-note">
    Evaluation prompt: "The course significantly increased my knowledge on the subject." &nbsp;
    Scores represent section-level means on a 1–5 agreement scale. University and departmental
    figures are institutional averages for the same semester.<br><br>
    * My individual scores are included within the Geography Department and University averages, as the data are not provided in a disaggregated form that would allow for their removal.
  </p>
</div>

<script>
  const labels = ['Fall 2022','Spring 2023','Fall 2023','Spring 2024','Fall 2024','Spring 2025','Fall 2025'];

  const kyle  = [4.52, 4.75, 4.89, 4.72, 4.76, 4.87, 4.72];
  const geo   = [4.41, 4.41, 4.57, 4.49, 4.64, 4.64, 4.41];
  const univ  = [4.47, 4.46, 4.48, 4.48, 4.52, 4.50, 4.52];

  const avg = arr => (arr.reduce((a,b)=>a+b,0)/arr.length).toFixed(2);

  // Update stat block with real average
  document.querySelector('.stat-value').textContent = avg(kyle);

  const ctx = document.getElementById('chart').getContext('2d');

  const baseDataset = (label, data, color, dash=[]) => ({
    label,
    data,
    borderColor: color,
    backgroundColor: color + '18',
    borderWidth: dash.length ? 1.5 : 2.5,
    borderDash: dash,
    pointBackgroundColor: color,
    pointBorderColor: '#fff',
    pointBorderWidth: 2,
    pointRadius: 5,
    pointHoverRadius: 7,
    tension: 0.35,
    fill: false,
  });

  const chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels,
      datasets: [
        baseDataset('My Courses', kyle, '#990000'),
        baseDataset('Geography Dept. Avg.', geo, '#C8A951', [5,4]),
        baseDataset('University Avg.', univ, '#6B8CA4', [3,3]),
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      interaction: { mode: 'index', intersect: false },
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: '#1A1714',
          titleColor: '#FAFAF7',
          bodyColor: '#C8C4BC',
          padding: 12,
          borderColor: '#3A3530',
          borderWidth: 1,
          titleFont: { family: "'Playfair Display', serif", size: 13 },
          bodyFont: { family: "'DM Sans', sans-serif", size: 12 },
          callbacks: {
            label: ctx => ` ${ctx.dataset.label}: ${ctx.parsed.y.toFixed(2)}`
          }
        }
      },
      scales: {
        x: {
          grid: { color: '#F0EDE8', drawTicks: false },
          border: { dash: [4, 4], color: '#E0DDD8' },
          ticks: {
            color: '#9A9590',
            font: { family: "'DM Sans', sans-serif", size: 11 },
            padding: 8,
          }
        },
        y: {
          min: 4.2,
          max: 5.0,
          grid: { color: '#F0EDE8', drawTicks: false },
          border: { display: false },
          ticks: {
            color: '#9A9590',
            font: { family: "'DM Sans', sans-serif", size: 11 },
            padding: 10,
            stepSize: 0.2,
            callback: v => v.toFixed(1),
          }
        }
      }
    }
  });

  // Legend click toggles
  document.querySelectorAll('.legend-item').forEach((el, i) => {
    el.addEventListener('click', () => {
      const meta = chart.getDatasetMeta(i);
      meta.hidden = !meta.hidden;
      el.style.opacity = meta.hidden ? '0.35' : '1';
      chart.update();
    });
  });
</script>
</body>
</html>
